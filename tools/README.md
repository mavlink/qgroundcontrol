# Development Tools

Utility scripts and tools for QGroundControl development.

## Quick Start Scripts

### `dev-setup.sh`
**One-time development environment setup**

Automates initial setup for contributors:
- Checks prerequisites (git, cmake, ninja, python)
- Initializes git submodules
- Installs pre-commit hooks
- Sets up cmake-format
- Detects Qt installation

Note: `.qmlls.ini` is auto-generated by CMake during configuration

```bash
./tools/dev-setup.sh
```

### `quick-build.sh`
**Fast build script with auto-detection**

Automatically finds Qt installation and builds QGroundControl.

```bash
# Debug build (default)
./tools/quick-build.sh

# Release build
./tools/quick-build.sh --release

# Clean build
./tools/quick-build.sh --clean

# Build and run tests
./tools/quick-build.sh --test

# Release build with tests
./tools/quick-build.sh --release --test
```

**Options:**
- `-r, --release` - Build Release instead of Debug
- `-c, --clean` - Clean build directory first
- `-t, --test` - Run unit tests after build
- `-h, --help` - Show help message

### `check-code-quality.sh`
**Code quality validation**

Runs formatting checks and linters:
- clang-format (C++ formatting)
- cmake-format (CMake formatting)
- YAML validation
- Trailing whitespace detection
- Line ending checks
- clang-tidy (optional, slow)

```bash
# Check code quality
./tools/check-code-quality.sh

# Fix formatting issues automatically
./tools/check-code-quality.sh --fix

# Run clang-tidy (comprehensive but slow)
./tools/check-code-quality.sh --clang-tidy

# Only check formatting
./tools/check-code-quality.sh --format-only
```

**Options:**
- `--fix` - Automatically fix formatting issues
- `--clang-tidy` - Run clang-tidy static analysis (slow)
- `--format-only` - Only check code formatting
- `-h, --help` - Show help message

## Configuration Files

### `ccache.conf`
Configuration for ccache compilation cache. Speeds up rebuilds.

### `qt6.natvis`
Visual Studio natvis file for Qt 6 types visualization in debugger.

## Other Directories

### `setup/`
Platform-specific setup scripts and dependencies.

### `reference/`
Reference materials and documentation for development.

## Usage Examples

**New contributor setup:**
```bash
# 1. Clone repository
git clone https://github.com/mavlink/qgroundcontrol.git
cd qgroundcontrol

# 2. Run setup script
./tools/dev-setup.sh

# 3. Build and run
./tools/quick-build.sh
./build/Debug/QGroundControl
```

**Before committing:**
```bash
# Check code quality
./tools/check-code-quality.sh

# Fix formatting issues
./tools/check-code-quality.sh --fix

# Or use pre-commit hooks (automatic)
git commit -m "Your changes"
```

**Quick rebuild after changes:**
```bash
./tools/quick-build.sh
```

**Full rebuild with tests:**
```bash
./tools/quick-build.sh --clean --test
```

## CI Integration

These scripts mirror the CI checks:
- Pre-commit hooks run automatically before commits
- GitHub Actions use similar formatting checks
- Local validation helps catch issues early

## Contributing

When adding new tools:
1. Follow existing script naming conventions
2. Add help messages (`--help`)
3. Use consistent color coding (GREEN=success, RED=error, YELLOW=warning)
4. Make scripts executable: `chmod +x script.sh`
5. Update this README

## Troubleshooting

**Qt not found:**
- Install Qt 6.10.0 from https://www.qt.io/download-qt-installer
- Or set Qt path manually in scripts

**Permission denied:**
```bash
chmod +x tools/*.sh
```

**Pre-commit hooks fail:**
```bash
# Install dependencies
pip install pre-commit cmake-format

# Re-run hooks
pre-commit run --all-files
```

**Build fails:**
```bash
# Clean and retry
./tools/quick-build.sh --clean

# Check CMakeLists.txt for errors
cmake-format --check CMakeLists.txt
```

---

**See also:**
- [QUICKSTART.md](../QUICKSTART.md) - Developer quick start guide
- [CONTRIBUTING.md](../.github/CONTRIBUTING.md) - Contribution guidelines
- [DEV_CONFIG.md](../.github/DEV_CONFIG.md) - Configuration files reference
